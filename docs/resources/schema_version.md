# axual_schema_version (Resource)

Schema version resource. Only version can be updated - this creates a new 'axual_schema_version'. Read more: https://docs.axual.io/axual/2024.2/self-service/schema-management.html

## Required Roles
- SCHEMA_AUTHOR or SCHEMA_ADMIN

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `body` (String) Avro schema
- `version` (String) The version of the schema

### Optional

- `description` (String) A short text describing the Schema version
- `owners` (String) The id of the team owning this Schema version .

### Read-Only

- `full_name` (String) Full name of the schema
- `id` (String) Schema version unique identifier
- `schema_id` (String) Schema unique identifier

## Note
- Changing any field of the schema_version is not allowed, and you should re-creates a new one with edited values.
- Please note that Updating the version of an existing schemaVersion is not an accepted behaviour and instead, should create a new schema version with same schema name, and different version and different schema body.

## Limitation
- `terraform import` functionality is not implemented, will be implemented soon
- To assign an owner to an existing schema or updating the owner, you need to first delete the schema and recreate it.
- To update the description, please delete and recreate the schema version.
- Make sure that you have required roles. Please note that you might have the permission to delete the schema(as `Schema Owner` if owner is present) but you might not have the `SCHEMA_AUTHOR` role(in a Tenant where `schema-roles-enforced=true`) that is required to create the schema.

## Example Usage

```hcl
resource "axual_schema_version" "axual_gitops_test_schema_version1" {
  body = file("avro-schemas/gitops_test_v1.avsc")
  version = "1.0.0"
  description = "Gitops test schema version"
}
```
An example of having one schema with different schemaVersions:

first schema body

```json
{
  "type": "record",
  "name": "GitOpsTest1",
  "namespace": "io.axual.qa.general",
  "doc": "Object type that is supposed to be filled with a gitops test value. This should be used when the Key is irrelevant.",
  "fields": [
    {
      "name": "gitops1",
      "type": "string",
      "doc": "The gitops test value. v 1.0.0"
    }
  ]
}
```

second schema body

```json
{
  "type": "record",
  "name": "GitOpsTest1",
  "namespace": "io.axual.qa.general",
  "doc": "Object type that is supposed to be filled with a gitops test value. This should be used when the Key is irrelevant.",
  "fields": [
    {
      "name": "gitops1",
      "type": "string",
      "doc": "The gitops1 test value. v 1.0.0"
    },
    {
      "name": "gitops2",
      "type": "string",
      "doc": "The gitops2 test value. v 1.0.0"
    }
  ]
}
```
```hcl
resource "axual_schema_version" "axual_gitops_test_schema_version1" {
  body = file("avro-schemas/gitops_test_v1.avsc") // first schema body
  version = "1.0.0"
  description = "Gitops test schema version"
}

resource "axual_schema_version" "axual_gitops_test_schema_version2" {
  body = file("avro-schemas/gitops_test_v2.avsc") // second schema body
  version = "2.0.0"
  description = "Gitops test schema version"
}
```

Please refer to the full example of the latest Axual TerraForm provider, check https://github.com/Axual/terraform-provider-axual/tree/master/examples/axual.